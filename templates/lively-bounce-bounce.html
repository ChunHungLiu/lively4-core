<template xmlns="http://www.w3.org/1999/xhtml" id="lively-bounce-bounce">
    <style>
        h2 {
            margin: 0px;
        }
        
        .large-rect {
            width: 300px;
            height: 200px;
            background-color: rgb(42, 161, 152);
        }
        
        .ball {
            border-radius: 50%;
            width: 100px;
            height: 100px;
            background-image: url("http://bupp.at/sites/default/files/styles/breite_350/public/red%20cov.png?itok=VYf4pmEQ");
            background-color: rgb(7, 54, 66);
            background-size: 100%;
        }
        
        :host {
            display: inline-block;
        }
    </style>
    <div class="large-rect" style="max-width: none; max-height: none; width: 358px; height: 493px;">
        <h2 style="position: relative;">v = -0.8829</h2><button onclick="this.doit()" class="" style="position: relative;">Start<script data-name="doit" type="lively4script">function doit() {
  this.parentElement.querySelector(".ball").startFalling();
}</script></button><button onclick="this.doit()" class="" style="position: relative;">Stop<script data-name="doit" type="lively4script">function doit() {
  this.parentElement.querySelector(".ball").stopFalling();
}</script></button><button onclick="this.doit()" class="" style="position: relative;">Reset<script data-name="doit" type="lively4script">function doit() {
  $(this.parentElement.querySelector(".ball")).css('top', 0);
}</script></button>
        <div class="ball" style="position: relative; left: 140px; top: 0px;">
            <script data-name="fall" type="lively4script">
                function fall() {
                    this.v += 9.81 * 0.005;
                    this.parentElement.querySelector("h2").innerHTML = "v = " + this.v.toFixed(4);
                    var bottom = this.parentElement.clientHeight;
                    var y = parseFloat(this.style.top);
                    if (y < bottom - this.clientHeight) {
                        $(this).css('top', y + this.v);
                        this.timeout = setTimeout(this.fall, 5);
                    } else {
                        this.bump();
                    }
                }
            </script>
            <script data-name="bump" type="lively4script">
                function bump() {
                    this.v -= 9.81 * 0.005;
                    this.parentElement.querySelector("h2").innerHTML = "v = -" + this.v.toFixed(4);
                    var bottom = this.parentElement.clientHeight;
                    var y = parseFloat(this.style.top);
                    if (this.v > 0) {
                        $(this).css('top', y - this.v);
                        this.timeout = setTimeout(this.bump, 5);
                    } else {
                        this.fall();
                    }
                }
            </script>
            <script data-name="startFalling" type="lively4script">
                function startFalling() {
                    this.v = 0;
                    this.fall();
                }
            </script>
            <script data-name="stopFalling" type="lively4script">
                function stopFalling() {
                    clearTimeout(this.timeout);
                }
            </script>
        </div>
    </div>
</template>
<script xmlns="http://www.w3.org/1999/xhtml" class="registrationScript">
    (function() {
        var template = document.currentScript.ownerDocument.querySelector('#lively-bounce-bounce');
        var clone = document.importNode(template.content, true);

        Promise.all([
            System.import('../src/client/morphic/component-loader.js')
        ]).then(modules => {
            var Loader = modules[0];
            Loader.register('lively-bounce-bounce', clone);
        });
    })();
</script>