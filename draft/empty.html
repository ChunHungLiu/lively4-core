<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
<title>Lively 4</title>
<style type="text/css" media="screen">

    body {
        margin: 0;
        font-family: sans-serif;
    }

    h1 {
        color: #2B65EC;
    }

</style>

<script src="https://code.jquery.com/jquery-2.1.4.js" type="text/javascript" charset="utf-8"></script>

<!--<link rel="import" href="../src/client/babel-system.html" /> -->
<!-- BEGIN SYSTEM.JS: should go away, until then we use a "static" global source -->
<script src="https://livelykernel.github.io/lively4-core/src/external/system.src.js" type="text/javascript" charset="utf-8"></script>
<script>
  System.paths['babel'] ='https://livelykernel.github.io/lively4-core/src/external/babel-browser.js'
  System.config({
    transpiler: 'babel',
    babelOptions: { },
    map: {
        babel: 'https://livelykernel.github.io/lively4-core/src/external/babel-browser.js'
    }
  });
</script>
<!-- END SYSTEM.JS-->

<link rel="import" href="../templates/lively-window.html" />
<link rel="import" href="../templates/lively-object-editor.html" />
<link rel="import" href="../templates/lively-file-browser.html" />

<link rel="import" href="../templates/lively-menu.html"/>

<link rel="import" href="../templates/lively-console.html"/>
<link rel="import" href="../templates/lively-editor.html"/>
<link rel="import" href="../templates/juicy-ace-editor.html"/>

<link rel="import" href="../templates/lively-tab-view.html" />
<link rel="import" href="../templates/lively-halos.html" />

<link rel="import" href="../templates/lively-key-value-input.html" />
<link rel="import" href="../templates/lively-key-value-map.html" />

<link rel="stylesheet" type="text/css" href="../src/client/css/morphic.css" />

</head>
<body>
<h1>Lively 4</h1>
<lively-halos></lively-halos>

<!-- BEGIN ACE -->
<!-- We also have to load ace "locally", because loading it remotely ends in a race condition -->


<script>
    var lively4url =  "../" // or any abosolute path to lively4 ? Any idea for computeRoot() ? #JensLincke #OpenQuestion

    System.import(lively4url + "/src/client/load.js").then(function(){
        console.log("lively loaded!")

        // System.import("commandline.js")
        // System.import(lively4url + "src/client/debug-serviceworker.js")

        // <lively-menu ></lively-menu>
        MyApp = {
            getMenuItems: function(){
                return [
                    ["Workspace", function() {
                        var container  = document.createElement("lively-window")
                        $('body')[0].appendChild(container)
                        var text  = document.createElement("juicy-ace-editor")
                        container.appendChild(text)

                    }],
                    ["File Editor", function() {
                        var container  = document.createElement("lively-window")
                        $('body')[0].appendChild(container)
                        var text  = document.createElement("lively-editor")
                        container.appendChild(text)

                    }],
                    ["File Browser", function() {
                        var appctx = document.createElement("lively-window")
                        var browser = document.createElement("lively-file-browser")
                        browser.addEventListener('file-select', (event) => {
                            var appctx = document.createElement("lively-window")
                            var editor = document.createElement("lively-editor")

                            editor.setURL(event.file.url)
                            editor.loadFile()

                            appctx.appendChild(editor)
                            document.body.appendChild(appctx)
                        })

                        appctx.appendChild(browser)
                        document.body.appendChild(appctx)

                    }],
                    ["Console", function() {
                        var container  = document.createElement("lively-window")
                        $('body')[0].appendChild(container)
                        var text  = document.createElement("lively-console")
                        container.appendChild(text)

                    }],
                    ["Text", function() {
                            var text  = document.createElement("p")
                            text.innerHTML = "Hello"
                            $('body')[0].appendChild(text)
                    }],
                    ["Rectangle", function() {
                        var morph  = document.createElement("div")
                        morph.style.height = "100px"
                        morph.style.width = "200px"
                        morph.style.backgroundColor = "blue"
                        $('body')[0].appendChild(morph)
                    }]
                ]
            }
        }


        var menu = document.createElement("lively-menu")
        var cb = function() {
            console.log("menu initialized")
            menu.openOn(MyApp)
        }
        if (menu.initialize) {
            console.log("initialze directly")
            cb()
        } else {
            console.log("register initialized callback")
            menu.addEventListener("initialized", cb)
        }
        $('body')[0].appendChild(menu)

    }).catch(function(err) {
        alert("load Lively4 failed: err")
    });

</script>


</body>
</html>
